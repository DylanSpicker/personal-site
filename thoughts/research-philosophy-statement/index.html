<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dylan Spicker">
<meta name="dcterms.date" content="2022-12-14">
<meta name="description" content="This document outlines my research experience, approach, and goals for the future.">

<title>Dylan Spicker - My Research Philosophy Statement</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Dylan Spicker</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../work.html"> 
<span class="menu-text">My Work</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html"> 
<span class="menu-text">My Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">My Thoughts</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#past-research" id="toc-past-research" class="nav-link active" data-scroll-target="#past-research">Past Research</a></li>
  <li><a href="#current-research" id="toc-current-research" class="nav-link" data-scroll-target="#current-research">Current Research</a></li>
  <li><a href="#future-research" id="toc-future-research" class="nav-link" data-scroll-target="#future-research">Future Research</a></li>
  <li><a href="#existing-and-planned-collaborative-research" id="toc-existing-and-planned-collaborative-research" class="nav-link" data-scroll-target="#existing-and-planned-collaborative-research">Existing and Planned Collaborative Research</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<div class="callout callout-style-default callout-tip no-icon callout-titled">
    <div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
    <div class="callout-icon-container">
    <i class="callout-icon no-icon"></i>
    </div>
    <div class="callout-title-container flex-fill">
    <span class="fs-2">Opportunity for current undergraduate and masters students…</span>
    </div>
    <div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
    </div>
    <div id="callout-1" class="callout-1-contents callout-collapse collapse">
    <div class="callout-body-container callout-body">
    <p><span class="fs-3 fw-bolder">I am currently recruiting graduate students at both the Masters and PhD level.</span></p>
    <p><span class="fs-3 fw-lighter">If you are interested in pursuing either a Masters or PhD in Statistics, and are interested in any of the research topics that I work on, please reach out. Even if you have a somewhat non-traditional background, but think that you would be a good fit, please get in touch with me.</span></p>
    <p><span class="fs-3 fw-lighter">These are <strong>funded opportunities</strong> with a lot of flexibility for you to grow and learn as a Statistician. Do not hesitate to reach out!</span></p>
    </div>
    </div>
</div>
<a href="../../blog.html" class="btn btn-outline-success mb-2">Back to 'My Thoughts'</a>

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">My Research Philosophy Statement</h1>
  <div class="quarto-categories">
    <div class="quarto-category">statistics</div>
    <div class="quarto-category">teaching</div>
    <div class="quarto-category">research</div>
    <div class="quarto-category">job search</div>
  </div>
  </div>

<div>
  <div class="description">
    This document outlines my research experience, approach, and goals for the future.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dylan Spicker </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 14, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Questions of causality sit at the heart of scientific inquiry and progress. While historically causality has been inferred through the use of randomised trials and experiments, the rate of growth of modern observational data and the corresponding complexity necessitates the development of novel causal techniques in order to ensure continued scientific progress. I am a causal inference researcher with an interest in developing novel methods to accommodate the growing complexity of modern data. I focus on developing techniques which are rigorously justified while remaining widely accessible. I am strongly committed to interdisciplinary research, which helps to ensure that my independent research remains grounded and readily applicable. I have a record of productive, impactful research, capable of attracting competitive funding. My interests are in burgeoning areas, tackling modern statistical issues, with diverse applied utility, and strongly integrated interdisciplinary partnerships. This provides access to a wide variety of funding sources, and serves as a strong foundation for a publishable, fundable, independent research program.</p>
<section id="past-research" class="level2">
<h2 class="anchored" data-anchor-id="past-research">Past Research</h2>
<p>My past work focused on developing methods which account for the effects of measurement error and misclassification in the context of causal inference with dynamic treatment regimes (DTRs). DTRs provide a framework for capturing causal inference in a longitudinal setting, often applied for precision medicine, where we estimate the optimal sequence of treatments for individual patients. Measurement error is a pervasive issue, particularly in biostatistics, occurring whenever a variate of interest cannot be accurately observed. I provided the first account of the impacts of measurement error on optimal DTR estimation, and developed the first set of estimators to correct for these issues [1]. Additionally, I highlighted the shortcomings of ignoring patient nonadherence in optimal DTR estimation, and provided a locally efficient, computationally feasible estimation technique for the valid estimation of causal effects in these settings [2]. This work has resulted in a manuscript published in <em>Statistics in Medicine</em>, a top-tier Biostatistics journal, with a secondary article under consideration, has received competitive NSERC grant funding, and has since spawned additional contributions in the field [3, 4]. Beyond my work in modern causal inference, I have developed general measurement error corrections, leveraging both nonparametric [5] and robust [6] statistics, producing two additional manuscripts which are currently under review.</p>
</section>
<section id="current-research" class="level2">
<h2 class="anchored" data-anchor-id="current-research">Current Research</h2>
<p>I am continuing to expand methods for optimal DTR estimation with complex data, where I have begun work related to patient privacy in DTR estimation. Differential privacy is a standard which ensures that reported estimates do not reveal too much information regarding any individual in a study, and preserving this privacy is critically important for statistical analyses in precision medicine. I am also working on techniques for sample size and power calculations within the DTR framework, an important area missing from the current literature. Outside of work on DTRs, my postdoctoral research focuses on the analysis of data from respondent-driven sampling (RDS). RDS combines benefits from probability based sampling and snowball sampling, providing an effective technique for researchers studying hard-to-reach populations. It has correspondingly seen wide uptake by applied researchers. Despite its frequent application, existing techniques for RDS analysis focus primarily on mean and proportion estimation, in a cross-sectional setting. I am developing a set of causal estimators using data arising from RDS, techniques which are essential for answering scientific questions with RDS data. Additionally, I am extending both the causal estimators and the existing mean estimators to a longitudinal RDS setting. This work is currently funded with a competitive postdoctoral grant, issued by CANSSI, and is motivated through a partnership with the Engage study. Engage is an ongoing, multicenter RDS, operating out of Montreal, Toronto, and Vancouver, aiming to “inform HIV and STBBI prevention techniques in the population of gay, bi, and queer men, including trans men, and other men who have sex with men.”</p>
</section>
<section id="future-research" class="level2">
<h2 class="anchored" data-anchor-id="future-research">Future Research</h2>
<p>Going forward, I will continue to develop novel methods in causal inference for modern issues in real-world data. In the short-term I will study complex outcomes in the context of DTRs. In the DTR literature, it is common to assume that there is a single outcome to be optimised for all individuals. In practice there are often multiple, competing outcomes. A medical treatment may be thought to increase life expectancy, but this needs to be balanced against potential negative side effects. Existing work on competing outcomes in DTRs ignores the multivariate nature of the problem, opting instead for simplified combinations using utility functions. This assumes that utility is estimable or else can be constructed, and that future patients will balance their priorities similarly. My proposed strategy will provide more flexibility for combinations of competing outcomes, compared with univariate utility functions. DTRs are typically studied under the assumption that there is a known, finite number of decisions to make. There is some work considering infinite time horizon DTRs through the use of Markovian assumptions. While these assumptions are mathematically convenient, they can be oversimplified in real-world scenarios, particularly in medical settings where delayed treatment effects are common. I will consider a joint modelling approach, treating the number of decisions as a random quantity in addition to the outcomes of interest. This joint modelling approach will borrow from standard longitudinal and survival analysis, and will provide a more realistic set of assumptions for real-world decision making. In the longer term, I will develop tools for causal inference on complex, modern data types. For instance, I will develop causal methodologies for both network and functional data. Both network and functional data are becoming more prominent, and each represents an important form of “big data”. Alongside the associational techniques used to study these large data sets, causal methods will be required to answer scientific questions which arise. This is particularly important as observational, rather than experimental, data are driving the increase in the availability of network and functional data. Causal network analysis has received some attention in the literature, but has remained relatively simple both in terms of associational structures and causal estimands (methods tend to assume only local interference patterns on networks in a way which often is not realistic). Functional data, on the other hand, have received comparatively little causal attention, despite the potential applied utility (for instance, with fMRI data).</p>
</section>
<section id="existing-and-planned-collaborative-research" class="level2">
<h2 class="anchored" data-anchor-id="existing-and-planned-collaborative-research">Existing and Planned Collaborative Research</h2>
<p>Beyond my impactful methodological developments, I have a strong focus on conducting interdisciplinary research. The purpose of this is two-fold: first, working with applied researchers helps to discern important methodological needs, ensuring that my independent research remains relevant. Second, the primary purpose of statistical methodology is for the advancement of scientific knowledge. Working on interdisciplinary research facilitates the theoretically valid application of cutting-edge statistical techniques, enhancing the pursuit of scientific knowledge. An example of this can be seen during my doctoral studies, where I established an ongoing research project with nutritional scientists, computer scientists, and statisticians. Our research aims to study the impacts of diet on health outcomes, while taking into account the complexities of dietary patterns (including combination effects which are historically ignored), using deep learning techniques. This ongoing project involves statistical methodology, algorithmic development, and nutritional science. In addition, during my postdoctoral studies, my work on RDS is directly informed by a close working relationship with medical and public health researchers from the aforementioned Engage study. This partnership ensures that the methodological developments are necessary, and will see applied use. Moving forward, I intend to continue initiating and participating in relevant interdisciplinary work, particularly in the health sciences. This provides exciting avenues for collaboration, a wider array of funding sources, and helps to ensure uptake of methodological developments. Several of my short-term projects provide opportunities for interdisciplinary research in personalised medicine, public health, and medical imaging. In addition to health applications, the possibility of industry collaboration exists, particularly related to functional and network data. Functional data is commonly observed in finance and speech recognition settings, while network data naturally arises in social networks and logistics tasks.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>[1] <strong>Spicker, Dylan</strong>, and Wallace, Michael P. Measurement error and precision medicine: Error-prone tailoring covariates in dynamic treatment regimes. Statistics in Medicine. 2020; 39: 3732– 3755. https://doi.org/10.1002/sim.8690</p>
<p>[2] <strong>Spicker , Dylan</strong>. Generalizations to Corrections of Measurement Error Effects for Dynamic Treatment Regimes. UWSpace. 2022. http://hdl.handle.net/10012/18581.</p>
<p>[3] Wallace, Michael. P. Measurement error and precision medicine. In T. Cai, B. Chakraborty, E. Laber, E. Moodie, and M. van der Laan, editors, Handbook of Statistical Methods for Precision Medicine [Accepted], Handbooks of Modern Statistical Methods. Chapman and Hall/CRC, Boca Raton Florida. 2022</p>
<p>[4] Liu, Dan. Regression-based Methods for Dynamic Treatment Regimes with Mismeasured Covariates or Misclassified Response. 2022.</p>
<p>[5] <strong>Spicker, Dylan</strong>, Wallace, Michael P., and Yi, Grace Y. Nonparametric Simulation Extrapolation for Measurement Error Models. arXiv preprint arXiv:2111.02863. 2021.</p>
<p>[6] <strong>Spicker, Dylan</strong>, Wallace, Michael P., and Yi, Grace Y. Generalizations to Corrections for the Effects of Measurement Error in Approximately Consistent Methodologies. arXiv preprint arXiv:2106.07401. 2021.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>